"""Static vulnerability catalog keyed by contract type."""

from __future__ import annotations

from typing import Dict, List

VULNERABILITY_CATALOG: Dict[str, List[str]] = {
    "test": [
        "When transferring tokens, if the amount to be sent is calculated rather than passed as a parameter, it is advisable to include an additional parameter that sets a minimum threshold for the transfer. This helps mitigate the risk of front-running attacks.",
    ],
}

_DEFAULT_FALLBACK = [
    "Analyze the code for any smart-contract related vulnerabilities and provide a detailed report.",
    "Provide a evidence-based explanation for why the vulnerabilities are exploitable.",
    "Provide a remediation plan for each vulnerability.",
]


def get_vulnerabilities(contract_type: str) -> List[str]:
    """Return catalog entries for the provided contract type."""
    if not contract_type:
        return _DEFAULT_FALLBACK

    normalized = contract_type.strip().lower()
    return VULNERABILITY_CATALOG.get(normalized, _DEFAULT_FALLBACK)
