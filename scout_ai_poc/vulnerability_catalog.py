"""Static vulnerability catalog keyed by contract type."""

from __future__ import annotations

from typing import Dict, List

VULNERABILITY_CATALOG: Dict[str, List[str]] = {
    "lending": [
        "Identify all critical security checks and business rules (e.g., is_frozen, utilization limits, admin-only access).",
        "Map out all distinct execution paths that can modify the same piece of state (e.g., `standard_swap` vs. `standard_swap_from`).",
        "Compare the validation logic across these parallel paths to ensure all required checks are applied consistently.",
        "Pay close attention to special-purpose functions (e.g., emergency functions, migrations) as they are common sources of missing validation.",
    ],
}

_DEFAULT_FALLBACK = [
    "Analyze the code for any smart-contract related vulnerabilities and provide a detailed report.",
    "Provide a evidence-based explanation for why the vulnerabilities are exploitable.",
    "Provide a remediation plan for each vulnerability.",
]


def get_vulnerabilities(contract_type: str) -> List[str]:
    """Return catalog entries for the provided contract type."""
    if not contract_type:
        return _DEFAULT_FALLBACK

    normalized = contract_type.strip().lower()
    return VULNERABILITY_CATALOG.get(normalized, _DEFAULT_FALLBACK)
