from typing import Literal, List, Tuple, Set

ContractType = Literal["lending"]

VULNERABILITIES: List[Tuple[str, Set[ContractType | Literal["ALL"]]]] = [
    (
        "If there is a function which under certain circumstances has the same behavior than another function, it should have the same validations. Otherwise, users could circumvent the validations through it. For instance, when transfer_batch() is called with only one element, it should have the same validations than transfer().",
        {"ALL"},
    ),
    (
        "If one parameter is an array, the program may need to validate there are no duplicated elements.",
        {"ALL"},
    ),
    (
        "Identify state variables that determine the rate of accumulation for time-dependent logic (e.g., total supply, principal, or active stakes). Verify that any function modifying these variables triggers the accrual or update mechanism strictly before the modification. This is to ensure that the time elapsed since the last interaction is settled using the pre-modification value, preventing the new value from being incorrectly applied retroactively to the past time interval.",
        {"ALL"},
    ),
    (
        "Identify sentinel values used to mark records as disabled, and verify that all functions iterating over or processing these records explicitly handle the case where the sentinel is set.",
        {"ALL"},
    ),
    (
        "In governance systems, decision-making procedures should be reviewed, as a low threshold creates a timing vulnerability where a fast-acting minority can push a decision that preempts the will of the final majority. Usually, this threshold's value represents the required majority or quorum.",
        {"ALL"},
    ),
]


def get_vulnerabilities(contract_type: str) -> List[str]:
    if not contract_type:
        return []
    target = contract_type.strip().lower()
    return [check for check, tags in VULNERABILITIES if "ALL" in tags or target in tags]
